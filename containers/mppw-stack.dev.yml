version: "3.8"
services:

  mppw:
    ports:
      - "${MPPW_EXTERNAL_PORT:-8000}:8000"
    environment:
      MONGODB_ADMIN_PASSWORD: password
      MPPW_MIGRATIONS_INCLUDE_SEED_DATA: "true"
      MPPW_GUIDE_SITE_FORCE_REBUILD: "true"
    volumes:
      - "${MPPW_LOCAL_PACKAGE_DIR:-./mppw}:/local/mppw"
    command: "bash -c 'cd local && uvicorn --host 0.0.0.0 mppw.main:app --debug --reload-include *.py --reload-include *.vue --reload-include *.md'"

  jupyterhub:
    ports:
      - "${JUPYTERHUB_EXTERNAL_PORT:-9000}:8000"

  mongodb:
    environment:
      MONGODB_ADMIN_PASSWORD: password
      MONGO_INITDB_ROOT_PASSWORD: password