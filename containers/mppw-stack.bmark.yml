version: "3.8"
services:
  mppw:
    ports:
      - "${MPPW_EXTERNAL_PORT:-8000}:8000"
    environment:
      MONGODB_ADMIN_PASSWORD: password
      MPPW_MIGRATIONS_INCLUDE_SEED_DATA: "true"
    volumes:
      - "${MPPW_LOCAL_PACKAGE_DIR:-./mppw/mppw}:/local/mppw"
      - "${MPPW_WEB_LOCAL_PACKAGE_DIR:-./mppw_web/mppw_web}:/local/mppw_web"
    command: "bash -c 'cd local && uvicorn --host 0.0.0.0 --log-level debug mppw.main:app'"

  jupyterhub:
    ports:
      - "${JUPYTERHUB_EXTERNAL_PORT:-9000}:8000"

  mongodb:
    environment:
      MONGODB_ADMIN_PASSWORD: password
      MONGO_INITDB_ROOT_PASSWORD: password
